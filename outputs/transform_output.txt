(venv) kaancakir@Kaans-MacBook-Air cryptocurrency-etl % python src/transform.py
25/10/31 16:52:59 WARN Utils: Your hostname, Kaans-MacBook-Air.local resolves to a loopback address: 127.0.0.1; using 172.16.1.20 instead (on interface en0)
25/10/31 16:52:59 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
25/10/31 16:52:59 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2025-10-31 16:53:00,164 [INFO] Spark session started
2025-10-31 16:53:02,611 [INFO] Loaded 5000 rows, 20 columns
2025-10-31 16:53:02,611 [INFO] Reading: data/raw/crypto_listings_20251031_131753.csv
2025-10-31 16:53:03,505 [INFO] Saved processed dataset -> data/processed/processed_crypto_listings_20251031_131753.parquet
2025-10-31 16:53:03,507 [INFO] Final schema: 21 columns
+----+-----------+------+--------+----+-------------------+----------------+---------------------+---------------------+--------------------+-------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+-----------+-------------------+------------------+--------------------------+
|id  |name       |symbol|slug    |rank|date_added         |num_market_pairs|circulating_supply   |total_supply         |max_supply          |last_updated       |percent_change_1h|percent_change_24h|percent_change_7d|percent_change_30d|percent_change_60d|percent_change_90d|price_usd  |market_cap_usd     |volume_24h_usd    |load_timestamp            |
+----+-----------+------+--------+----+-------------------+----------------+---------------------+---------------------+--------------------+-------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+-----------+-------------------+------------------+--------------------------+
|1   |Bitcoin    |BTC   |bitcoin |1   |2010-07-13 00:00:00|12462           |1.9942509E7          |1.9942509E7          |2.1E7               |2025-10-31 13:15:00|-0.09173939      |1.34923011        |-1.06924805      |-5.62194665       |0.72866742        |-3.01055197       |110015.6749|2.19398858630835E12|6.360411318421E10 |2025-10-31 13:53:03.526958|
|1027|Ethereum   |ETH   |ethereum|2   |2015-08-07 00:00:00|10998           |1.2069795557826006E8 |1.2069795557826006E8 |NULL                |2025-10-31 13:15:00|-0.34815814      |0.58818092        |-2.79694821      |-10.34864993      |-12.61694808      |9.94872362        |3852.5765  |4.6499810345744E11 |3.711974696973E10 |2025-10-31 13:53:03.526958|
|825 |Tether USDt|USDT  |tether  |3   |2015-02-25 00:00:00|155895          |1.8339991724120792E11|1.8596123541651736E11|NULL                |2025-10-31 13:15:00|0.03216411       |-0.02339485       |-0.03656394      |-0.04487845       |-0.03199557       |0.0179886         |0.9998     |1.8336994459525E11 |1.4377317462723E11|2025-10-31 13:53:03.526958|
|52  |XRP        |XRP   |xrp     |4   |2013-08-04 00:00:00|1746            |6.0017279517E10      |9.9985778283E10      |1.0E11              |2025-10-31 13:15:00|0.19960668       |0.36217073        |1.01106155       |-14.76179233      |-9.19240251       |-14.14600446      |2.5125     |1.5079621384095E11 |5.25782555673E9   |2025-10-31 13:53:03.526958|
|1839|BNB        |BNB   |bnb     |5   |2017-07-25 00:00:00|2901            |1.3773797032999998E8 |1.3773797032999998E8 |1.3773797032999998E8|2025-10-31 13:16:00|-0.60872078      |-1.88281706       |-4.13585255      |5.83468735        |26.75520358       |43.70556211       |1081.5362  |1.4896859993852E11 |5.02144165179E9   |2025-10-31 13:53:03.526958|
|5426|Solana     |SOL   |solana  |6   |2020-04-10 00:00:00|1042            |5.4982264343869E8    |6.129863267461731E8  |NULL                |2025-10-31 13:15:00|-0.58171155      |-0.55829489       |-3.51863182      |-14.75338561      |-6.45375224       |13.98853342       |186.9652   |1.0279771895948E11 |7.25853433167E9   |2025-10-31 13:53:03.526958|
|3408|USDC       |USDC  |usd-coin|7   |2018-10-08 00:00:00|33784           |7.572085879818997E10 |7.572085879818997E10 |NULL                |2025-10-31 13:15:00|0.04148414       |0.00838889        |0.00990821       |0.02804077        |-0.0125482        |0.02053116        |1.0        |7.5720465715E10    |1.907343981173E10 |2025-10-31 13:53:03.526958|
|74  |Dogecoin   |DOGE  |dogecoin|8   |2013-12-15 00:00:00|1344            |1.515784763837052E11 |1.515784763837052E11 |NULL                |2025-10-31 13:15:00|-0.52550393      |0.35658305        |-6.40107325      |-23.78347611      |-14.09406084      |-6.50550751       |0.1854     |2.809763078031E10  |2.45501425797E9   |2025-10-31 13:53:03.526958|
|1958|TRON       |TRX   |tron    |9   |2017-09-13 00:00:00|1258            |9.466614006801021E10 |9.46661570233383E10  |NULL                |2025-10-31 13:15:00|-0.01411531      |0.91652622        |-4.89909668      |-12.70641063      |-12.40132489      |-9.39967712       |0.2957     |2.799302954589E10  |1.00333713119E9   |2025-10-31 13:53:03.526958|
|2010|Cardano    |ADA   |cardano |10  |2017-10-01 00:00:00|1618            |3.5854459397418884E10|4.4994478516770386E10|4.5E10              |2025-10-31 13:15:00|-0.39189078      |-1.23561405       |-6.2765439       |-26.61255042      |-25.34851014      |-13.76410509      |0.613      |2.197999819961E10  |1.14084087784E9   |2025-10-31 13:53:03.526958|
+----+-----------+------+--------+----+-------------------+----------------+---------------------+---------------------+--------------------+-------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+-----------+-------------------+------------------+--------------------------+
only showing top 10 rows
2025-10-31 16:53:03,615 [INFO] Closing down clientserver connection